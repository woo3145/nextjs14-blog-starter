---
title: 'ë½€ëª¨ë‹­ ê°œë°œê¸° 8í¸ - í”ŒëŸ¬í„°ê°€ ë§í•œë‹¤ê³ ? Flutter ì „í™˜ê¸° (2)'
description: ë¼ìš°íŒ… ë° êµ¬ê¸€ ì• ë“œëª¹ ì ìš©
date: '2024-05-03'
image: 'https://d2quahb2ygxiv.cloudfront.net/f543bea9849fb3a9d6b6b.png'
authors:
  - woo3145
tags:
  - ğŸ¥Pomodak
  - Project
  - Flutter
  - Mobile
published: false
---

ìµœê·¼ í”ŒëŸ¬í„° íŒ€ì´ ëŒ€ê·œëª¨ í•´ê³ ë¥¼ ë‹¹í•´ì„œ í”ŒëŸ¬í„°ê°€ ë²„ë ¤ì§„ë‹¤ëŠ” ì†Œë¬¸ì´ ëŒê³ ìˆìŠµë‹ˆë‹¤.

ì´ì—ë”°ë¼ í”„ë¡œë•íŠ¸ ë§¤ë‹ˆì € [Michael Thomsenì´ ì•„ë˜ì™€ ê°™ì€ íŠ¸ìœ—](https://twitter.com/walkingriver/status/1786041534455980225)ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤.

![image](https://d2quahb2ygxiv.cloudfront.net/543bea9849fb3a9d6b6b2.png)

ëª‡ì‹œê°„ì „ ëŒ“ê¸€ì—ì„œ í”ŒëŸ¬í„° ê°œë°œìë¥¼ ì±„ìš©í•  ì˜ˆì •ì´ë¼ê³  ë°íŒ ê²ƒì„ ë³´ë©´ í”ŒëŸ¬í„°ê°€ ë²„ë ¤ì§„ë‹¤ëŠ” ì†Œë¬¸ì€ ì‚¬ì‹¤ì´ ì•„ë‹Œ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ê·¸ì € êµ¬ê¸€ì˜ ì „ì²´ì ì¸ êµ¬ì¡°ì¡°ì •ì¤‘ í”ŒëŸ¬í„°íŒ€ë„ ê·¸ì— ë”°ë¥¸ êµ¬ì¡°ì¡°ì •ì´ ìˆë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ê·¸ë˜ë„ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë‚˜ í”„ë ˆì„ì›Œí¬ëŠ” ì–¸ì œë“ ì§€ ì‚¬ë¼ì§ˆ ìˆ˜ë„ ìˆê³ , ìƒˆë¡œìš´ ê¸°ìˆ ì´ ë‚˜ì˜¤ê¸°ë„ í•˜ë‹ˆ ê·¸ì € í˜„ì¬ì˜ ê¸°ìˆ ì„ ì˜ í™œìš©í•˜ê³  ë¹ ë¥´ê²Œ ì ì‘í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•œ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

ê·¸ëŸ¼ ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ë½€ëª¨ë‹­ ì´ì•¼ê¸°ë¥¼ ì‹œì‘í•´ë³´ê² ìŠµë‹ˆë‹¤.

## ë¼ìš°íŒ… êµ¬í˜„

í”ŒëŸ¬í„°ì—ì„œ ë¼ìš°íŒ…ì€ `Navigator ìœ„ì ¯`ì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤. ìŠ¤íƒ êµ¬ì¡°ë¡œ ë˜ì–´ìˆì–´ì„œ `push`, `pop`ì„ í†µí•´ í™”ë©´ì„ ì „í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`Widget.of(context)`ëŠ” ìƒìœ„ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì ¯ì„ ì°¾ì•„ì£¼ëŠ” ì—­í• ì„ í•˜ëŠ”ë° ì´ë¥¼ ì´ìš©í•´ ê°€ì¥ ê°€ê¹Œìš´ Navigatorë¥¼ ì°¾ì•„ ë¼ìš°íŒ…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- `Navigator.of(context).push('/route')` or `Navigator.push(context, '/route')`
- `Navigator.of(context).pop()` or `Navigator.pop(context)`

- ì¶”ê°€ë¡œ `Navigator.of(context, rootNavigator: true)`ë¥¼ ì‚¬ìš©í•˜ë©´ ìµœìƒë‹¨ì˜ Navigatorë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### go_router íŒ¨í‚¤ì§€ ì‚¬ìš©

ì œê°€ ì›í•˜ëŠ” ë¼ìš°íŒ… ë™ì‘ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- `splash í™”ë©´`ì—ì„œ í•„ìˆ˜ ì´ˆê¸° ë°ì´í„° ë¡œë”©
- ë¼ìš°í„°ê°€ `viewModel`ì„ í†µí•´ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ê°ì§€í•˜ê³  ì´ì— ë”°ë¼ í™”ë©´ ì „í™˜
- ìƒíƒœì— ë”°ë¼ ë¦¬ë‹¤ì´ë ‰íŠ¸(ì´ˆê¸°í™”ê°€ ì•ˆë˜ì—ˆì„ë•Œ ë‹¤ë¥¸ ë¼ìš°í„° ì ‘ê·¼, ë¡œê·¸ì¸ëœ ìƒíƒœì—ì„œ ë¡œê·¸ì¸ í˜ì´ì§€ ì ‘ê·¼ ë“±)

Navigatorë¥¼ ì‚¬ìš©í•˜ë©´ ë§ì´ ë³µì¡í•´ì§€ê¸° ë•Œë¬¸ì— ì´ë¥¼ ì¢€ë” ê°„í¸í•˜ê²Œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ `go_router` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

`go_router`ëŠ” ê¸°ì¡´ Navigatorì™€ ë‹¬ë¦¬ URL ê¸°ë°˜ì˜ ë¼ìš°íŒ…ì„ ì§€ì›í•˜ëŠ” íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤.

ì œì¼ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë©”ì„œë“œëŠ” ë‹¤ìŒ 3ê°€ì§€ ì…ë‹ˆë‹¤.

- `context.go('/route')` : í•´ë‹¹ ê²½ë¡œë¡œ ì´ë™
- `context.push('/route')` : í•´ë‹¹ ê²½ë¡œë¡œ ì´ë™í•˜ê³  ì´ì „ ê²½ë¡œë¥¼ ìŠ¤íƒì— ì €ì¥
- `context.pop()` : ì´ì „ ê²½ë¡œë¡œ ì´ë™

[go_routerì˜ ë¬¸ì„œ](https://pub.dev/documentation/go_router/latest/go_router/go_router-library.html)ì—ì„œ ì—¬ëŸ¬ ë©”ì„œë“œ ì‚¬ìš©ë²•ì„ ì°¾ê¸° êµ‰ì¥íˆ ì–´ë µê¸° ë–„ë¬¸ì— `Command + í´ë¦­`ì„ í†µí•´ í•„ìš”í•œ ë©”ì„œë“œë¥¼ ì°¾ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.

### providerì™€ go_routerë¥¼ í†µí•œ ë¼ìš°íŒ… êµ¬í˜„

ë¼ìš°íŒ…ì„ ìœ„í•œ `AppRouter` í´ë˜ìŠ¤ì˜ ì „ì²´ì ì¸ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```dart
GlobalKey<NavigatorState> navigatorKey = GlobalKey<NavigatorState>();

class AppRouter {
  final AppViewModel appViewModel;
  final AuthViewModel authViewModel;
  late final GoRouter _goRouter;

  AppRouter({required this.appViewModel, required this.authViewModel}) {
    _goRouter = _initGoRouter();
  }

  GoRouter get router => _goRouter;

  GoRouter _initGoRouter() {
    return GoRouter(
      refreshListenable: Listenable.merge([appViewModel, authViewModel]),
      initialLocation: AppPage.splash.toPath,
      routes: _getRoutes(),
      errorBuilder: (context, state) =>
          ErrorPage(error: state.error.toString()),
      redirect: _redirectLogic,
      navigatorKey: navigatorKey,
    );
  }

  List<GoRoute> _getRoutes() {
    return [
      GoRoute(
        path: AppPage.home.toPath,
        name: AppPage.home.toName,
        builder: (context, state) => const MyHomePage(),
      ),
      GoRoute(
        path: AppPage.splash.toPath,
        name: AppPage.splash.toName,
        builder: (context, state) => const SplashPage(),
      ),
        // ...
    ];
  }

  String? _redirectLogic(BuildContext context, GoRouterState state) {
    final isLoggedIn = authViewModel.isLoggedIn;
    final isInitialized = appViewModel.initialized;

    final locations = {
        // ...
      'login': state.namedLocation(AppPage.login.toName),
      'home': state.namedLocation(AppPage.home.toName),
      'splash': state.namedLocation(AppPage.splash.toName),
    };

    if (!isInitialized && state.matchedLocation != locations['splash']) {
      return locations['splash'];
    }

    if ((isLoggedIn &&
            (state.matchedLocation == locations['login'] ||
                state.matchedLocation == locations['welcome'] ||
                state.matchedLocation == locations['register'])) ||
        (isInitialized && state.matchedLocation == locations['splash'])) {
      return locations['home'];
    }
    // ...

    return null;
  }
}

```

#### viewModelì„ í†µí•œ ìƒíƒœ ê°ì§€

ë¨¼ì € ë¼ìš°í„°ê°€ ê°ì§€í•´ì•¼í•  ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

- `appViewModel` : ì•±ì˜ ì´ˆê¸°í™” ì—¬ë¶€
- `authViewModel` : ë¡œê·¸ì¸ ì—¬ë¶€(jwt í† í°ì´ ì¡´ì¬í•˜ëŠ”ì§€)

goRouterì—ì„  `refreshListenable`ì„ í†µí•´ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•  ìˆ˜ ìˆê³  mergeë¥¼ í†µí•´ ì—¬ëŸ¬ê°œì˜ ë¦¬ìŠ¤ë„ˆë¥¼ ë“±ë¡í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```dart
// app_router.dart

AppRouter({required this.appViewModel, required this.authViewModel}) {
    _goRouter = _initGoRouter();
}

GoRouter _initGoRouter() {
    return GoRouter(
        refreshListenable: Listenable.merge([appViewModel, authViewModel]),
        // ...
    );
}

// main.dart
final appRouter = AppRouter(
    appViewModel: getIt<AppViewModel>(),
    authViewModel: getIt<AuthViewModel>());
final goRouter = appRouter.router;

MaterialApp.router(
    // ...
    routerConfig: goRouter,
)
```

#### redirect ì²˜ë¦¬

ì´ì œ providerë¥¼ í†µí•´ ìƒíƒœë¥¼ ê°ì§€í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìœ¼ë‹ˆ ì´ë¥¼ í†µí•´ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

`locations`ì—ì„œ ì´ë™í•˜ë ¤ëŠ” í˜ì´ì§€ì˜ ê²½ë¡œë¥¼ ë¯¸ë¦¬ ì €ì¥í•´ë‘ê³ , `state.matchedLocation`ì„ í†µí•´ í˜„ì¬ ìœ„ì¹˜ì™€ ë¹„êµí•˜ì—¬ í•´ë‹¹ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ˆê¸°í™” & ë¡œê·¸ì¸ ì—¬ë¶€ì™€ ê²°í•©í•˜ì—¬ ì ì ˆí•œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ í†µí•´ ì ‘ê·¼ì„ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```dart
// app_router.dart

String? _redirectLogic(BuildContext context, GoRouterState state) {
    final isLoggedIn = authViewModel.isLoggedIn;
    final isInitialized = appViewModel.initialized;

    final locations = {
        // ...
      'login': state.namedLocation(AppPage.login.toName),
      'home': state.namedLocation(AppPage.home.toName),
      'splash': state.namedLocation(AppPage.splash.toName),
    };

    // ì´ˆê¸°í™”ê°€ ë˜ì§€ ì•Šì•˜ì„ë•Œ ë¬´ì¡°ê±´ splash í˜ì´ì§€ë¡œ ì´ë™
    if (!isInitialized) {
      return locations['splash'];
    }

    // ë¡œê·¸ì¸ì´ ë˜ì–´ìˆëŠ”ë° ë¡œê·¸ì¸ ê´€ë ¨ í˜ì´ì§€ë¡œ ì ‘ê·¼í•˜ê±°ë‚˜ ì´ˆê¸°í™”ê°€ ì´ë¯¸ ì™„ë£Œë˜ì—ˆëŠ”ë° splash í˜ì´ì§€ë¡œ ì ‘ê·¼í•˜ë©´ home í˜ì´ì§€ë¡œ ì´ë™
    if ((isLoggedIn &&
            (state.matchedLocation == locations['login'] ||
                state.matchedLocation == locations['welcome'] ||
                state.matchedLocation == locations['register'])) ||
        (isInitialized && state.matchedLocation == locations['splash'])) {
      return locations['home'];
    }
    // ... ë‹¤ì–‘í•œ ìƒí™© ì²˜ë¦¬

    return null;
}
```

## êµ¬ê¸€ ì• ë“œëª¹ ì ìš©

ìƒê°ì¤‘ì¸ ê´‘ê³ ëŠ” ë°°ë„ˆì™€ ë³´ìƒí˜• ê´‘ê³ ì˜€ìœ¼ë©° ì´ë¥¼ ìœ„í•´ `google_mobile_ads` íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ê´‘ê³ ë¥¼ ì ìš©í•˜ê¸° ì „ì— ì•±ì˜ í¬ì¸íŠ¸ íšë“ ëª¨ë¸ì„ ê°œì„ í•˜ëŠ” ì‘ì—…ì„ ë¨¼ì € ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

### í¬ì¸íŠ¸ íšë“ëª¨ë¸ ê°œì„ 

ê¸°ì¡´ í¬ì¸íŠ¸ë¥¼ íšë“í•˜ëŠ” ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ì•˜ìŠµë‹ˆë‹¤.

- ë¬´ë£Œì•Œ êµ¬ë§¤
- íƒ€ì´ë¨¸ ì‚¬ìš© (120ë¶„)
- ì•Œ ì‚¬ìš©
- 100 ~ 200 í¬ì¸íŠ¸ íšë“

ì•Œì€ ìµœëŒ€ 4ê°œê¹Œì§€ ë³´ìœ í•  ìˆ˜ ìˆê³  íƒ€ì´ë¨¸ ì‚¬ìš©ì‹œ ë³´ìœ í•œ ì•Œë“¤ì˜ ìš”êµ¬ì‹œê°„ì´ ì±„ì›Œì§€ê³ , 4ê°œë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ë©´ 2ì‹œê°„ì— ìµœëŒ€ 800í¬ì¸íŠ¸ë¥¼ íšë“í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

ì—¬ê¸°ì„œ ë¦¬ì›Œë“œ ê´‘ê³ ë¥¼ ì ìš© í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ì´ ë– ì˜¤ë¦…ë‹ˆë‹¤.

- ë³´ìƒí˜• ê´‘ê³ ë¥¼ í†µí•´ ì¡°ê¸ˆë” ê°•í™”ëœ ê´‘ê³ ì•Œ êµ¬ë§¤
- ì•Œ ì‚¬ìš©ì‹œ ê´‘ê³  ì‹œì²­ì„ í†µí•´ ë³´ìƒì„ ì—…ê·¸ë ˆì´ë“œ

ë˜í•œ í¬ì¸íŠ¸ íšë“ ì´ì™¸ì—ë„ ìºë¦­í„° ë½‘ê¸°ë¥¼ ìœ„í•œ ì•Œë„ 2ì‹œê°„ ì •ë„ì˜ ìš”êµ¬ì‹œê°„ì„ ê°€ì§€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ í•´ë‹¹ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤.

- ì¤‘ê°„ì¤‘ê°„ ì•Œì„ êµ¬ë§¤í•´ì•¼í•˜ëŠ” ë²ˆê±°ë¡œì›€
- ì•Œì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  íƒ€ì´ë¨¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì†í•´ë³´ëŠ” ëŠë‚Œ
- í¬ì¸íŠ¸ë¥¼ ëª¨ì•„ ìºë¦­í„° ì•Œì„ êµ¬ë§¤í•´ë„ 2ì‹œê°„ ì •ë„ì˜ ìš”êµ¬ì‹œê°„ì´ í•„ìš”

ë§¤ë²ˆ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì´ê¸°ì— í”¼ë¡œê°ì„ ì¤„ì´ê³ , ì§‘ì¤‘ì„ ë•ê¸° ìœ„í•œ ì•±ì˜ ëª©ì ì— ë§ì¶° ë‹¤ìŒê³¼ ê°™ì´ ê°œì„ í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.

- ë½€ëª¨ë„ë¡œ ì§‘ì¤‘ & ì¼ë°˜ íƒ€ì´ë¨¸ ì‚¬ìš© ì‹œ ë¶„ë‹¹ 9í¬ì¸íŠ¸ íšë“
- ê¸°ì¡´ ìºë¦­í„° ë½‘ê¸°ë¥¼ ìœ„í•œ ì•Œ ìš”êµ¬ì‹œê°„ ì œê±°
- ì•Œì˜ ìš”êµ¬ì‹œê°„ì€ íŠ¹ë³„í•œ ì•Œì—ë§Œ ì ìš© (ì´ë²¤íŠ¸ ì•Œ, ì‹œì¦Œ ì•Œ ë“±)

ì´ë¥¼ í†µí•´ ì‚¬ìš©ìê°€ íƒ€ì´ë¨¸ ì‚¬ìš©ì‹œ ì¤‘ê°„ì¤‘ê°„ ì•Œì„ êµ¬ë§¤í•˜ëŠ” ë²ˆê±°ë¡œì›€ì„ ì¤„ì´ê³ , ì‰¬ëŠ” íƒ€ì„ì— í¬ì¸íŠ¸ë¥¼ í†µí•´ ìºë¦­í„° ë½‘ê¸°ë¥¼ í•  ìˆ˜ ìˆê²Œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.

í¬ì¸íŠ¸ íšë“ëŸ‰ì€ ì‹œê°„ë‹¹ 540í¬ì¸íŠ¸ë¥¼ íšë“í•  ìˆ˜ ìˆë„ë¡ ê¸°ì¤€ì„ ì¡ì•˜ìŠµë‹ˆë‹¤.

í•´ë‹¹ ë¹„ìœ¨ì€ ê°€ì¥ ë‚®ì€ ìºë¦­í„° ë½‘ê¸° ë¹„ìš©ì„ ê¸°ì¤€ìœ¼ë¡œ 1ì‹œê°„ë‹¹ 1íšŒ ì •ë„ì˜ ìºë¦­í„° ë½‘ê¸°ë¥¼ í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.

![alt text](?width=500)

### ë¦¬ì›Œë“œí˜• ê´‘ê³  ì ìš©

í¬ì¸íŠ¸ íšë“ëª¨ë¸ ê°œì„ ì— ë”°ë¼ ë¦¬ì›Œë“œí˜• ê´‘ê³ ë¥¼ ì ìš©í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.

íƒ€ì´ë¨¸ë¥¼ ì¢…ë£Œí• ë•Œ í¬ì¸íŠ¸ë¥¼ ì§€ê¸‰í•˜ê³  ì•ŒëŒ í˜ì´ì§€ì—ì„œ ê´‘ê³  ì‹œì²­ í›„ í•œë²ˆë” í¬ì¸íŠ¸ë¥¼ ì§€ê¸‰í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì ìš©í–ˆìŠµë‹ˆë‹¤.

ì´ë¥¼ í†µí•´ ì‚¬ìš©ìê°€ íƒ€ì´ë¨¸ ì¢…ë£Œ í›„ ê´‘ê³  ì‹œì²­ì„ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë©° ì´ë¥¼ í†µí•´ ì¶”ê°€ì ì¸ í¬ì¸íŠ¸ë¥¼ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¦¬ì›Œë“œ ê´‘ê³  ì ìš©ì„ ì§„í–‰í•˜ë©° ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì„ ìƒê°í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.

- ê´‘ê³ ë¥¼ ë¡œë“œí•  ì‹œì 
- ê´‘ê³ ë¥¼ ì‹œì²­í•œ í›„ ë³´ìƒ ì§€ê¸‰
- ë°˜ë³µì ì¸ ê´‘ê³  ì‹œì²­ ë°©ì§€

ë¨¼ì € ê´‘ê³ ë¥¼ ë¡œë“œí• ë•Œ ì‹œê°„ì´ ì¢€ ê±¸ë¦½ë‹ˆë‹¤. ê¸°ì¡´ì— ì•ŒëŒí˜ì´ì§€ì— ë„ì°© í›„ ê´‘ê³ ë¥¼ ë¡œë“œí•˜ë©´ ìµœëŒ€ 3ì´ˆ ~ 4ì´ˆ ê¹Œì§€ ê±¸ë¦¬ëŠ” ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤.

ì´ëŠ” ì‚¬ìš©ìê°€ ê´‘ê³ ë¥¼ ë³´ê¸°ë„ ì „ì— í™•ì¸ì„ ëˆŒëŸ¬ í˜ì´ì§€ë¥¼ ë²—ì–´ë‚˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ê´‘ê³ ë¥¼ ë¡œë“œí•˜ëŠ” ì‹œì ì„ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤.

ë³´í†µ 5ë¼ìš´ë“œ ì¢…ë£Œ í›„ ê´‘ê³ ë¥¼ ë„ìš°ë ¤ë©´ 3ë¼ìš´ë“œì¯¤ ê´‘ê³ ë¥¼ ë¡œë“œí•˜ëŠ” ê²ƒì´ ì ì ˆí•˜ë‹¤ê³  ê¶Œì¥ë˜ê³  ìˆìŠµë‹ˆë‹¤.

ë˜ ì´ë¥¼ ìœ„í•´ ì‹±ê¸€í†¤ìœ¼ë¡œ ê´‘ê³ ë¥¼ ë¡œë“œí•˜ê³ , ì‹œì²­í•œ í›„ì—ëŠ” ìƒˆ ê´‘ê³ ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ ì´ˆê¸°í™”ë¥¼ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.

ë”°ë¼ì„œ ì €ê°™ì€ ê²½ìš°ëŠ” provider íŒ¨í‚¤ì§€ë¡œ mvvm íŒ¨í„´ì„ ë”°ë¥´ê³  ìˆê¸°ì— ë³´ìƒí˜• ê´‘ê³ ë¥¼ ìœ„í•œ `RewardedAdViewModel`ì„ ë§Œë“¤ì–´ì„œ ê´€ë¦¬í–ˆìŠµë‹ˆë‹¤.

```dart
class RewardedAdViewModel extends ChangeNotifier {
  RewardedAd? _rewardedAd; // ë³´ìƒí˜• ê´‘ê³  ê°ì²´
  bool _rewardEarned = false; // ë³´ìƒ íšë“ ìƒíƒœ
  bool isAdReady = false; // ê´‘ê³ ê°€ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ì˜ ì—¬ë¶€

  // ë³´ìƒí˜• ê´‘ê³ ë¥¼ ë¡œë“œ (íƒ€ì´ë¨¸ í˜ì´ì§€ì—ì„œ ë¯¸ë¦¬ í˜¸ì¶œ)
  void loadRewardedAd() {
    RewardedAd.load(
      adUnitId: AdMobHelper.rewardedAdUnitId,
      request: const AdRequest(),
      rewardedAdLoadCallback: RewardedAdLoadCallback(
        onAdLoaded: (RewardedAd ad) {
          debugPrint('ë³´ìƒí˜• ê´‘ê³  ë¡œë“œ ì™„ë£Œ');
          _rewardedAd = ad;
          isAdReady = true;
          notifyListeners();
        },
        onAdFailedToLoad: (LoadAdError error) {
          debugPrint('ë³´ìƒí˜• ê´‘ê³  ë¡œë“œ ì‹¤íŒ¨: ${error.message}');
          isAdReady = false;
          notifyListeners();
        },
      ),
    );
  }

  // ì¤€ë¹„ëœ ê´‘ê³  í‘œì‹œ
  void showRewardedAd({int points = 0}) {
    if (_rewardedAd == null || !isAdReady) {
      debugPrint('ê´‘ê³  ì¤€ë¹„ ì•ˆ ë¨.');
      return;
    }

    _rewardedAd!.fullScreenContentCallback = FullScreenContentCallback(
      onAdShowedFullScreenContent: (RewardedAd ad) => debugPrint('ê´‘ê³  í‘œì‹œë¨.'),
      onAdDismissedFullScreenContent: (RewardedAd ad) {
        debugPrint('ê´‘ê³  ë‹«í˜');
        if (_rewardEarned) {
          MessageUtil.showSuccessToast("$points í¬ì¸íŠ¸ë¥¼ ì¶”ê°€ íšë“í•˜ì˜€ìŠµë‹ˆë‹¤!!");
        }
        ad.dispose(); // ê´‘ê³  ë‹«í ë•Œ ë¦¬ì†ŒìŠ¤ í•´ì œ
        _rewardEarned = false;
        isAdReady = false;
        _rewardedAd = null;
        notifyListeners();
      },
      onAdFailedToShowFullScreenContent: (RewardedAd ad, AdError error) {
        debugPrint('ë³´ìƒí˜• ê´‘ê³  í‘œì‹œ ì‹¤íŒ¨: ${error.message}');
        ad.dispose(); // í‘œì‹œ ì‹¤íŒ¨ì‹œ ë¦¬ì†ŒìŠ¤ í•´ì œ
        _rewardEarned = false;
        isAdReady = false;
        _rewardedAd = null;
        notifyListeners();
      },
    );

    _rewardedAd!.show(
      onUserEarnedReward: (AdWithoutView ad, RewardItem reward) {
        debugPrint('ë³´ìƒ íšë“: ${reward.type}, ìˆ˜ëŸ‰ ${reward.amount}');

        if (reward.type == 'double_points') {
          // í¬ì¸íŠ¸ í•œë²ˆ ë” ì ë¦½
          getIt<TransactionViewModel>().rewardPoints(points);
          _rewardEarned = true; // ì•±ìœ¼ë¡œ ëŒì•„ê°€ ë³´ìƒ íšë“ ì—¬ë¶€ë¥¼ ì•Œë¦¬ê¸° ìœ„í•œ í”Œë˜ê·¸
        }
      },
    );
  }

  @override
  void dispose() {
    _rewardedAd?.dispose();
    super.dispose();
  }
}
```

ì¶”ê°€ë¡œ ì£¼ì˜í•  ì ì€ onUserEarnedRewardì—ì„œ ê´‘ê³ ë¥¼ ë„ìš¸ ë•Œ ë£¨íŠ¸ ìœ„ì ¯ì—ì„œ ë„ìš°ëŠ” toastê°€ ë³´ì´ì§€ ì•Šê¸° ë•Œë¬¸ì— flagë¥¼ í†µí•´ ê´‘ê³ ê°€ ë‹«ì€ í›„ íšë“ ì—¬ë¶€ì— ë”°ë¼ toastë¥¼ ë„ìš°ë„ë¡ í–ˆìŠµë‹ˆë‹¤.

ìœ„ ë·°ëª¨ë¸ì„ ë£¨íŠ¸ì— ë“±ë¡í•˜ê³  íƒ€ì´ë¨¸ë¥¼ ì‹œì‘ í›„ ê´‘ê³ ë¥¼ ë¡œë“œí•˜ë„ë¡ í•˜ì—¬ íƒ€ì´ë¨¸ ì¢…ë£Œ ì‹œ ì¤€ë¹„ëœ ê´‘ê³ ë¥¼ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.

ë˜í•œ ê´‘ê³ ë¥¼ ì§§ì€ ì‹œê°„ì— ë°˜ë³µì ìœ¼ë¡œ ì‹œì²­í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ê´‘ê³ ë¥¼ ì‹œì²­í•œ í›„ ë¡œì»¬ì— ì‹œì²­í•œ ì‹œê°„ì„ ì €ì¥í•˜ê³ , ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ì§€ ì•Šìœ¼ë©´ ë²„íŠ¼ì„ ë¹„í™œì„±í™” í•˜ì—¬ ë°˜ë³µì ì¸ ê´‘ê³  ì‹œì²­ì„ ë°©ì§€í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.
